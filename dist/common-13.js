LavaPack.loadBundle([[7594,{"../../app/scripts/lib/util":276,"../../shared/constants/app":5447,"../../shared/constants/hardware-wallets":5456,"../../shared/constants/metametrics":5462,"../../shared/lib/four-byte":5528,"../../shared/lib/sentry":5540,"../../shared/lib/switch-direction":5544,"../../shared/lib/trace":5546,"../../shared/modules/conversion.utils":5558,"../../shared/modules/error":5560,"../../shared/modules/hexstring-utils":5564,"../../shared/modules/i18n":5565,"../../shared/modules/selectors":5574,"../../shared/modules/selectors/networks":5575,"../../shared/modules/string-utils":5579,"../components/app/toast-master/utils":6014,"../ducks/alerts/unconnected-account":6643,"../ducks/metamask/metamask":6659,"../ducks/send":6664,"../helpers/constants/notifications":6675,"../hooks/multichain-accounts/utils":6765,"../pages/confirmations/selectors/preferences":7255,"../pages/swaps/swaps.util":7547,"../selectors":7568,"./actionConstants":7593,"./background-connection":7595,"@metamask/account-tree-controller":1088,"@metamask/chain-agnostic-permission":1301,"@metamask/rpc-errors":2421,"@metamask/snaps-utils":2713,buffer:3793,lodash:4565,loglevel:4573,"webextension-polyfill":5430},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(t,e,n){(function(e){(function(){Object.defineProperty(n,"__esModule",{value:!0}),n.abortTransactionSigning=function(t){return async e=>{try{await(0,C.submitRequestToBackground)("abortTransactionSigning",[t])}catch(t){e(gt(t))}}},n.accountTrackerStartPolling=async function(t){const e=await(0,C.submitRequestToBackground)("accountTrackerStartPolling",[t]);return await St(e),e},n.accountTrackerStopPollingByPollingToken=async function(t){await(0,C.submitRequestToBackground)("accountTrackerStopPollingByPollingToken",[t]),await Rt(t)},n.addImportedTokens=function(t,e){return async n=>{try{await(0,C.submitRequestToBackground)("addImportedTokens",[t,e])}catch(t){(0,M.logErrorWithMessage)(t)}finally{await ht(n)}}},n.addNetwork=function(t){return async e=>{r.default.debug("background.addNetwork",t);try{return await(0,C.submitRequestToBackground)("addNetwork",[t])}catch(t){(0,M.logErrorWithMessage)(t),e(gt("Had a problem adding networks!"))}return undefined}},n.addNewAccount=function(t,e=!0){return r.default.debug("background.addNewAccount"),async(n,a)=>{const o=(0,w.getMetaMaskHdKeyrings)(a()),[s]=o;let i=s;if(t&&(i=o.find(e=>e.metadata.id===t)),!i)throw r.default.error("Should never reach this. There is always a keyring"),new Error("Keyring not found");const c=i.accounts;let u;e&&n(ct());try{const e=await(0,C.submitRequestToBackground)("addNewAccount",[c.length,t]);await ht(n);const r=a();u=(0,w.getInternalAccountByAddress)(r,e)}catch(t){throw n(gt(t)),t}finally{e&&n(dt())}return u}},n.addNft=function(t,e,n,a){return async r=>{if(!t)throw new Error("MetaMask - Cannot add NFT without address");if(!e)throw new Error("MetaMask - Cannot add NFT without tokenID");a||r(ct());try{await(0,C.submitRequestToBackground)("addNft",[t,e,n])}catch(t){(0,M.logErrorWithMessage)(t),r(gt(t))}finally{await ht(r),r(dt())}}},n.addNftVerifyOwnership=function(t,e,n,a){return async r=>{if(!t)throw new Error("MetaMask - Cannot add NFT without address");if(!e)throw new Error("MetaMask - Cannot add NFT without tokenID");if(!n)throw new Error("MetaMask - Cannot add NFT without a networkClientId");a||r(ct());try{await(0,C.submitRequestToBackground)("addNftVerifyOwnership",[t,e,n])}catch(t){if((0,M.isErrorWithMessage)(t)){const e=(0,M.getErrorMessage)(t);if(e.includes("This NFT is not owned by the user")||e.includes("Unable to verify ownership"))throw t;(0,M.logErrorWithMessage)(t),r(gt(t))}}finally{await ht(r),r(dt())}}},n.addPermittedAccount=function(t,e){return async n=>{await new Promise((n,a)=>{(0,C.callBackgroundMethod)("addPermittedAccount",[t,e],t=>{t?a(t):n()})}),await ht(n)}},n.addPermittedAccounts=function(t,e){return async n=>{await new Promise((n,a)=>{(0,C.callBackgroundMethod)("addPermittedAccounts",[t,e],t=>{t?a(t):n()})}),await ht(n)}},n.addPermittedChain=function(t,e){return async n=>{await new Promise((n,a)=>{(0,C.callBackgroundMethod)("addPermittedChain",[t,e],t=>{t?a(t):n()})}),await ht(n)}},n.addPermittedChains=function(t,e){return async n=>{await new Promise((n,a)=>{(0,C.callBackgroundMethod)("addPermittedChains",[t,e],t=>{t?a(t):n()})}),await ht(n)}},n.addPollingTokenToAppState=St,n.addToAddressBook=function(t,e="",n="",a){return r.default.debug("background.addToAddressBook"),async(r,o)=>{const s=a||(0,m.getProviderConfig)(o()).chainId;let i;try{i=await(0,C.submitRequestToBackground)("setAddressBook",[(0,k.toChecksumHexAddress)(t),e,s,n]),await ht(r)}catch(t){throw(0,M.logErrorWithMessage)(t),r(gt("Address book failed to update")),t}i||r(gt("Address book failed to update"))}},n.addToken=function({address:t,symbol:e,decimals:n,image:a,networkClientId:r},o){return async s=>{if(!t)throw new Error("MetaMask - Cannot add token without address");o||s(ct());try{await(0,C.submitRequestToBackground)("addToken",[{address:t,symbol:e,decimals:n,image:a,networkClientId:r}])}catch(t){(0,M.logErrorWithMessage)(t),s(gt(t))}finally{await ht(s),s(dt())}}},n.addTransaction=async function(t,e){r.default.debug("background.addTransaction");const n=(0,C.generateActionId)();return await(0,C.submitRequestToBackground)("addTransaction",[t,{...e,origin:g.ORIGIN_METAMASK,actionId:n}])},n.addTransactionAndRouteToConfirmationPage=function(t,e){return async n=>{const a=(0,C.generateActionId)();try{r.default.debug("background.addTransaction");const o=await(0,C.submitRequestToBackground)("addTransaction",[t,{...e,actionId:a,origin:g.ORIGIN_METAMASK}]);return n(rt()),o}catch(t){throw n(dt()),n(gt(t)),t}}},n.addTransactionAndWaitForPublish=async function(t,e){r.default.debug("background.addTransactionAndWaitForPublish");const n=(0,C.generateActionId)();return await(0,C.submitRequestToBackground)("addTransactionAndWaitForPublish",[t,{...e,origin:g.ORIGIN_METAMASK,actionId:n}])},n.applyTransactionContainersExisting=async function(t,e){return await(0,C.submitRequestToBackground)("applyTransactionContainersExisting",[t,e])},n.approvePermissionsRequest=function(t){return e=>{(0,C.callBackgroundMethod)("approvePermissionsRequest",[t],t=>{t&&e(gt(t)),ht(e)})}},n.attemptCloseNotificationPopup=At,n.attemptLedgerTransportCreation=async function(){return await(0,C.submitRequestToBackground)("attemptLedgerTransportCreation")},n.automaticallySwitchNetwork=function(t){return async e=>{await e(ot(t)),await ht(e)}},n.backupUserData=async function(){let t;try{t=await(0,C.submitRequestToBackground)("backupUserData")}catch(t){throw(0,M.logErrorWithMessage)(t),t}return t},n.cancelDecryptMsg=function(t){return async e=>{e(ct());try{await(0,C.submitRequestToBackground)("cancelDecryptMessage",[t.id])}finally{e(dt())}return await ht(e),e(j(t.id)),e(it()),t}},n.cancelEncryptionPublicKeyMsg=function(t){return async e=>{e(ct());try{await(0,C.submitRequestToBackground)("cancelEncryptionPublicKey",[t.id])}finally{e(dt())}return await ht(e),e(j(t.id)),e(it()),t}},n.cancelQrCodeScan=function(){return async()=>{await(0,C.submitRequestToBackground)("cancelQrCodeScan")}},n.cancelSmartTransaction=function(t){return async e=>{try{await(0,C.submitRequestToBackground)("cancelSmartTransaction",[t])}catch(t){if((0,M.logErrorWithMessage)(t),(0,M.isErrorWithMessage)(t)){const n=(0,M.getErrorMessage)(t);if(n.startsWith("Fetch error:")){const t=(0,E.parseSmartTransactionsError)(n);e({type:O.SET_SMART_TRANSACTIONS_ERROR,payload:t})}}throw t}}},n.cancelTx=function(t,e=!0){return n=>(e&&n(ct()),new Promise((e,n)=>{(0,C.callBackgroundMethod)("rejectPendingApproval",[String(t.id),s.providerErrors.userRejectedRequest().serialize()],t=>{t?n(t):e()})}).then(()=>ht(n)).then(()=>(n((0,y.resetSendState)()),n(j(t.id)),n(dt()),n(it()),t)).catch(t=>{throw n(dt()),t}))},n.cancelTxs=function(t){return async e=>{e(ct());try{const n=t.map(({id:t})=>t),a=n.map(t=>new Promise((e,n)=>{(0,C.callBackgroundMethod)("rejectPendingApproval",[String(t),s.providerErrors.userRejectedRequest().serialize()],t=>{t?n(t):e()})}));await Promise.all(a),await ht(e),e((0,y.resetSendState)()),n.forEach(t=>{e(j(t))})}finally{(0,f.getEnvironmentType)()===g.ENVIRONMENT_TYPE_NOTIFICATION?At():e(dt())}}},n.captureSingleException=function(t){return async(e,n)=>{const{singleExceptions:a}=n().appState;t in a||(e({type:O.CAPTURE_SINGLE_EXCEPTION,value:t}),(0,d.captureException)(Error(t)))}},n.captureTestBackgroundError=async function(t){await(0,C.submitRequestToBackground)("captureTestError",[t])},n.changePassword=function(t,e){return async n=>{try{await(0,C.submitRequestToBackground)("changePassword",[t,e])}catch(t){throw n(gt(t)),t}}},n.checkAccountsPresence=function(t){return async()=>{try{return await(0,C.submitRequestToBackground)("checkAccountsPresence",[t])}catch(t){throw(0,M.logErrorWithMessage)(t),t}}},n.checkAndUpdateAllNftsOwnershipStatus=async function(t){await(0,C.submitRequestToBackground)("checkAndUpdateAllNftsOwnershipStatus",[t])},n.checkAndUpdateSingleNftOwnershipStatus=async function(t,e){await(0,C.submitRequestToBackground)("checkAndUpdateSingleNftOwnershipStatus",[t,!1,e])},n.checkHardwareStatus=function(t,e){return r.default.debug("background.checkHardwareStatus",t,e),async n=>{n(ct());let a=!1;try{a=await(0,C.submitRequestToBackground)("checkHardwareStatus",[t,e])}catch(t){throw(0,M.logErrorWithMessage)(t),n(gt(t)),t}finally{n(dt())}return await ht(n),a}},n.checkIsSeedlessPasswordOutdated=function(t=!0){return async e=>{let n=!1;try{n=await(0,C.submitRequestToBackground)("checkIsSeedlessPasswordOutdated",[t]),n&&await ht(e)}catch(t){r.default.warn("checkIsSeedlessPasswordOutdated error",t)}return n}},n.clearAccountDetails=function(){return{type:O.CLEAR_ACCOUNT_DETAILS}},n.clearPendingTokens=function(){return{type:O.CLEAR_PENDING_TOKENS}},n.clearProductTour=function(){return(0,C.submitRequestToBackground)("setProductTour",[""])},n.clearSmartTransactionFees=function(){(0,C.submitRequestToBackground)("clearSmartTransactionFees")},n.clearSwapsQuotes=function(){return async t=>{await(0,C.submitRequestToBackground)("clearSwapsQuotes"),await ht(t)}},n.closeCurrentNotificationWindow=it,n.closeWelcomeScreen=function(){return{type:O.CLOSE_WELCOME_SCREEN}},n.completeOnboarding=mt,n.completeQrCodeScan=function(t){return async()=>{await(0,C.submitRequestToBackground)("completeQrCodeScan",[t])}},n.completedTx=j,n.connectHardware=function(t,e,n,a,s){return r.default.debug("background.connectHardware",t,e,n),async(r,i)=>{const{ledgerTransportType:c}=i().metamask;let u;r(ct(`Looking for your ${(0,o.capitalize)(t)}...`));try{if(a&&t===p.HardwareDeviceNames.ledger&&c===p.LedgerTransportTypes.webhid){const t=!1;let e=[];t||(e=await window.navigator.hid.requestDevice({filters:[{vendorId:p.LEDGER_USB_VENDOR_ID}]}));if(!(t||e.some(t=>t.vendorId===Number(p.LEDGER_USB_VENDOR_ID))))throw new Error(s("ledgerWebHIDNotConnectedErrorMessage"))}u=await(0,C.submitRequestToBackground)("connectHardware",[t,e,n])}catch(e){(0,M.logErrorWithMessage)(e);const n=(0,M.getErrorMessage)(e);throw t===p.HardwareDeviceNames.ledger&&c===p.LedgerTransportTypes.webhid&&(0,M.isErrorWithMessage)(e)&&n.match("Failed to open the device")?(r(gt(s("ledgerDeviceOpenFailureMessage"))),new Error(s("ledgerDeviceOpenFailureMessage"))):(t!==p.HardwareDeviceNames.qr&&r(gt(e)),e)}finally{r(dt())}return await ht(r),u}},n.createCancelTransaction=function(t,e,n={}){let a;return r.default.debug("background.createCancelTransaction"),r=>{const o=(0,C.generateActionId)();return new Promise((s,i)=>{(0,C.callBackgroundMethod)("createCancelTransaction",[t,e,{...n,actionId:o}],(e,n)=>{var o;if(e)return null!=e&&null!==(o=e.message)&&void 0!==o&&o.includes("Previous transaction is already confirmed")&&r(st({name:"TRANSACTION_ALREADY_CONFIRMED",originalTransactionId:t})),r(gt(e)),void i(e);if(n){const t=(0,w.getCurrentNetworkTransactions)({metamask:n}),{id:e}=t[t.length-1];a=e,s()}})}).then(()=>ht(r)).then(()=>a)}},n.createEventFragment=function(t){const e=(0,C.generateActionId)();return(0,C.submitRequestToBackground)("createEventFragment",[{...t,actionId:e}])},n.createMetaMetricsDataDeletionTask=async function(){return await(0,C.submitRequestToBackground)("createMetaMetricsDataDeletionTask")},n.createNewVault=H,n.createNewVaultAndGetSeedPhrase=function(t){return async e=>{try{await H(t);return await K(t)}catch(t){throw e(gt(t)),(0,M.isErrorWithMessage)(t)?new Error((0,M.getErrorMessage)(t)):t}}},n.createNewVaultAndRestore=function(t,n){return a=>{a(ct()),r.default.debug("background.createNewVaultAndRestore");const o=Array.from(e.from(n,"utf8").values());return new Promise((e,n)=>{(0,C.callBackgroundMethod)("createNewVaultAndRestore",[t,o],t=>{t?n(t):e()})}).then(()=>a($())).then(()=>{a(at()),a(dt())}).catch(t=>(a(gt(t)),a(dt()),Promise.reject(t)))}},n.createNewVaultAndSyncWithSocial=function(t){return async e=>{try{const n=await H(t);if(!n)throw new Error("No keyring found");const a=await K(t);return await G(t,a,n.metadata.id),e(ft()),a}catch(t){throw e(gt(t)),(0,M.isErrorWithMessage)(t)?new Error((0,M.getErrorMessage)(t)):t}}},n.createNextMultichainAccountGroup=function(t){return async e=>{r.default.debug("background.createNextMultichainAccountGroup");try{const n=(0,_.stripWalletTypePrefixFromWalletId)(t);await(0,C.submitRequestToBackground)("createNextMultichainAccountGroup",[n]),await ht(e)}catch(t){(0,M.logErrorWithMessage)(t)}}},n.createOnChainTriggers=function(){return async()=>{try{await(0,C.submitRequestToBackground)("createOnChainTriggers")}catch(t){throw(0,M.logErrorWithMessage)(t),t}}},n.createRetryTransaction=function(t,e){let n;return a=>new Promise((r,o)=>{const s=(0,C.generateActionId)();(0,C.callBackgroundMethod)("createSpeedUpTransaction",[t,e,{actionId:s}],(t,e)=>{if(t)return a(gt(t)),void o(t);if(e){const t=(0,w.getCurrentNetworkTransactions)(e);n=t[t.length-1],r()}})}).then(()=>ht(a)).then(()=>n)},n.createSeedPhraseBackup=G,n.createSnapAccount=async function(t,e,n){return await(0,C.submitRequestToBackground)("createSnapAccount",[t,e,n])},n.createSpeedUpTransaction=function(t,e,n={}){let a;return r.default.debug("background.createSpeedUpTransaction"),r=>{const o=(0,C.generateActionId)();return new Promise((s,i)=>{(0,C.callBackgroundMethod)("createSpeedUpTransaction",[t,e,{...n,actionId:o}],(t,e)=>{if(t)return r(gt(t)),void i(t);if(e){const t=(0,w.getCurrentNetworkTransactions)(e);a=t[t.length-1],s()}})}).then(()=>ht(r)).then(()=>a)}},n.createTransactionEventFragment=function(t){const e=(0,C.generateActionId)();return(0,C.submitRequestToBackground)("createTransactionEventFragment",[{transactionId:t,actionId:e}])},n.currencyRateStartPolling=async function(t){const e=await(0,C.submitRequestToBackground)("currencyRateStartPolling",[{nativeCurrencies:t}]);return await St(e),e},n.currencyRateStopPollingByPollingToken=async function(t){await(0,C.submitRequestToBackground)("currencyRateStopPollingByPollingToken",[t]),await Rt(t)},n.decodeTransactionData=async function({transactionData:t,contractAddress:e,chainId:n}){return await(0,C.submitRequestToBackground)("decodeTransactionData",[{transactionData:t,contractAddress:e,chainId:n}])},n.decryptMsg=function(t){return r.default.debug("action - decryptMsg"),async e=>{e(ct()),r.default.debug("actions calling background.decryptMessage");try{await(0,C.submitRequestToBackground)("decryptMessage",[t])}catch(t){throw(0,M.logErrorWithMessage)(t),e(gt(t)),t}finally{e(dt())}return await ht(e),e(j(t.metamaskId)),e(it()),t}},n.decryptMsgInline=function(t){return r.default.debug("action - decryptMsgInline"),async e=>{r.default.debug("actions calling background.decryptMessageInline");try{await(0,C.submitRequestToBackground)("decryptMessageInline",[t])}catch(t){throw(0,M.logErrorWithMessage)(t),e(gt(t)),t}return(await ht(e)).unapprovedDecryptMsgs[t.metamaskId]}},n.deleteAccountSyncingDataFromUserStorage=function(){return async()=>{try{await Promise.all([(0,C.submitRequestToBackground)("deleteAccountSyncingDataFromUserStorage",[c.USER_STORAGE_GROUPS_FEATURE_KEY]),(0,C.submitRequestToBackground)("deleteAccountSyncingDataFromUserStorage",[c.USER_STORAGE_WALLETS_FEATURE_KEY])])}catch(t){throw(0,M.logErrorWithMessage)(t),t}}},n.deleteExpiredNotifications=function(){return async(t,e)=>{const n=e().metamask.metamaskNotificationsList.filter(t=>{const e=new Date(Date.now()-I.NOTIFICATIONS_EXPIRATION_DELAY);return Boolean(t.readDate&&new Date(t.readDate)<e)}).map(({id:t})=>t);n.length&&(await(0,C.submitRequestToBackground)("deleteNotificationsById",[n]),await ht(t))}},n.deleteInterface=function(t){return async e=>{await(0,C.submitRequestToBackground)("deleteInterface",[t]),await ht(e)}},n.deleteNotificationsById=function(t){return async()=>{try{return await(0,C.submitRequestToBackground)("deleteNotificationsById",[t])}catch(t){throw(0,M.logErrorWithMessage)(t),t}}},n.detectNfts=function(t){return async e=>{e(ut()),r.default.debug("background.detectNfts");try{await(0,C.submitRequestToBackground)("detectNfts",[t])}finally{e(lt())}await ht(e)}},n.detectTokens=function(){return async t=>{t(ct()),r.default.debug("background.detectTokens"),await(0,C.submitRequestToBackground)("detectTokens"),t(dt()),await ht(t)}},n.disableAccounts=function(t){return async()=>{try{await(0,C.submitRequestToBackground)("disableAccounts",[t])}catch(t){throw(0,M.logErrorWithMessage)(t),t}}},n.disableMetamaskNotifications=function(){return async()=>{try{await(0,C.submitRequestToBackground)("disableMetamaskNotifications")}catch(t){throw r.default.error(t),t}}},n.disableSnap=function(t){return async e=>{await(0,C.submitRequestToBackground)("disableSnap",[t]),await ht(e)}},n.disconnectOriginFromSnap=function(t,e){return async n=>{await(0,C.submitRequestToBackground)("disconnectOriginFromSnap",[t,e]),await ht(n)}},n.dismissSmartTransactionsErrorMessage=function(){return{type:O.DISMISS_SMART_TRANSACTIONS_ERROR_MESSAGE}},n.displayWarning=gt,n.enableAccounts=function(t){return async()=>{try{await(0,C.submitRequestToBackground)("enableAccounts",[t])}catch(t){throw(0,M.logErrorWithMessage)(t),t}}},n.enableMetamaskNotifications=function(){return async()=>{try{await(0,C.submitRequestToBackground)("enableMetamaskNotifications")}catch(t){throw r.default.error(t),t}}},n.enableSnap=function(t){return async e=>{await(0,C.submitRequestToBackground)("enableSnap",[t]),await ht(e)}},n.encryptionPublicKeyMsg=function(t){return r.default.debug("action - encryptionPublicKeyMsg"),async e=>{e(ct()),r.default.debug("actions calling background.encryptionPublicKey");try{await(0,C.submitRequestToBackground)("encryptionPublicKey",[t])}catch(t){throw(0,M.logErrorWithMessage)(t),e(gt(t)),t}finally{e(dt())}return await ht(e),e(j(t.metamaskId)),e(it()),t}},n.endBackgroundTrace=async function(t){const e=t.timestamp||performance.timeOrigin+performance.now();await(0,C.submitRequestToBackground)("endTrace",[{...t,timestamp:e}])},n.estimateGas=function(t){return(0,C.submitRequestToBackground)("estimateGas",[t])},n.exportAccount=function(t,e,n,a){return function(o){return o(ct()),r.default.debug("background.verifyPassword"),new Promise((s,i)=>{(0,C.callBackgroundMethod)("verifyPassword",[t],function(c){if(c)return r.default.error("Error in verifying password."),o(dt()),o(gt("Incorrect Password.")),void i(c);r.default.debug("background.exportAccount"),(0,C.callBackgroundMethod)("exportAccount",[e,t],function(t,e){if(o(dt()),t)return(0,M.logErrorWithMessage)(t),o(gt("Had a problem exporting the account.")),void i(t);n(e),a(!0),s(e)})})})}},n.exportAccounts=function(t,e){return function(n){return r.default.debug("background.verifyPassword"),new Promise((a,o)=>{(0,C.callBackgroundMethod)("verifyPassword",[t],function(s){if(s)return r.default.error("Error in submitting password."),void o(s);r.default.debug("background.exportAccounts");const i=e.map(e=>new Promise((a,r)=>(0,C.callBackgroundMethod)("exportAccount",[e,t],function(t,e){if(t)return(0,M.logErrorWithMessage)(t),n(gt("Had a problem exporting the account.")),void r(t);a(e)})));a(Promise.all(i))})})}},n.fetchAndSetQuotes=function(t,e){return async n=>{const[a,r]=await(0,N.trace)({name:N.TraceName.SwapQuotesFetched},async()=>await(0,C.submitRequestToBackground)("fetchAndSetQuotes",[t,e]));return await ht(n),[a,r]}},n.fetchAndUpdateMetamaskNotifications=function(t){return async()=>{try{return await(0,C.submitRequestToBackground)("fetchAndUpdateMetamaskNotifications",[t])}catch(t){throw(0,M.logErrorWithMessage)(t),t}}},n.fetchHistoricalPricesForAsset=function(t){return async e=>{r.default.debug("background.fetchHistoricalPricesForAsset"),await(0,C.submitRequestToBackground)("fetchHistoricalPricesForAsset",[t]),await ht(e)}},n.fetchSmartTransactionFees=function(t,e){return async n=>{e&&(e.value="0x0");try{const a=await await(0,C.submitRequestToBackground)("fetchSmartTransactionFees",[t,e]);return n({type:O.SET_SMART_TRANSACTIONS_ERROR,payload:null}),a}catch(t){if((0,M.logErrorWithMessage)(t),(0,M.isErrorWithMessage)(t)){const e=(0,M.getErrorMessage)(t);if(e.startsWith("Fetch error:")){const t=(0,E.parseSmartTransactionsError)(e);n({type:O.SET_SMART_TRANSACTIONS_ERROR,payload:t})}}throw t}}},n.fetchSmartTransactionsLiveness=function({networkClientId:t}={}){return async()=>{try{await(0,C.submitRequestToBackground)("fetchSmartTransactionsLiveness",[{networkClientId:t}])}catch(t){(0,M.logErrorWithMessage)(t)}}},n.finalizeEventFragment=function(t,e){return(0,C.submitRequestToBackground)("finalizeEventFragment",[t,e])},n.findNetworkClientIdByChainId=async function(t){return await(0,C.submitRequestToBackground)("findNetworkClientIdByChainId",[t])},n.forceUpdateMetamaskState=ht,n.forgetDevice=function(t){return r.default.debug("background.forgetDevice",t),async e=>{e(ct());try{await(0,C.submitRequestToBackground)("forgetDevice",[t])}catch(t){throw(0,M.logErrorWithMessage)(t),e(gt(t)),t}finally{e(dt())}await ht(e)}},n.gasFeeStartPollingByNetworkClientId=async function(t){const e=await(0,C.submitRequestToBackground)("gasFeeStartPolling",[{networkClientId:t}]);return await St(e),e},n.gasFeeStopPollingByPollingToken=async function(t){await(0,C.submitRequestToBackground)("gasFeeStopPollingByPollingToken",[t]),await Rt(t)},n.generateNewMnemonicAndAddToVault=function(){return t=>(t(ct()),r.default.debug("background.generateNewMnemonicAndAddToVault"),new Promise((t,e)=>{(0,C.callBackgroundMethod)("generateNewMnemonicAndAddToVault",[],n=>{n?e(n):t()})}).then(async()=>{t(dt())}).catch(e=>(t(gt(e)),t(dt()),Promise.reject(e))))},n.getBalancesInSingleCall=async function(t,e,n){return await(0,C.submitRequestToBackground)("getBalancesInSingleCall",[t,e,n])},n.getCode=async function(t,e){return await(0,C.submitRequestToBackground)("getCode",[t,e])},n.getContractMethodData=function(t=""){return async(e,n)=>{const a=(0,f.addHexPrefix)(t).slice(0,10);if(a.length<10)return{};const{knownMethodData:o,use4ByteResolution:s}=n().metamask;if(null!=o&&o[a]&&0!==Object.keys(o[a]).length)return o[a];r.default.debug("loadingMethodData");const{name:i,params:c}=await(0,P.getMethodDataAsync)(a,s);return(0,C.callBackgroundMethod)("addKnownMethodData",[a,{name:i,params:c}],t=>{t&&e(gt(t))}),{name:i,params:c}}},n.getCurrentNetworkEIP1559Compatibility=async function(){let t;try{t=await(0,C.submitRequestToBackground)("getCurrentNetworkEIP1559Compatibility")}catch(t){console.error(t)}return t},n.getERC1155BalanceOf=async function(t,e,n,a){return await(0,C.submitRequestToBackground)("getERC1155BalanceOf",[t,e,n,a])},n.getERC721AssetSymbol=async function(t,e){return await(0,C.submitRequestToBackground)("getERC721AssetSymbol",[t,e])},n.getGasFeeTimeEstimate=function(t,e){return(0,C.submitRequestToBackground)("getGasFeeTimeEstimate",[t,e])},n.getLastInteractedConfirmationInfo=async function(){return await(0,C.submitRequestToBackground)("getLastInteractedConfirmationInfo")},n.getLayer1GasFee=function({chainId:t,networkClientId:e,transactionParams:n}){return async()=>await(0,C.submitRequestToBackground)("getLayer1GasFee",[{chainId:t,networkClientId:e,transactionParams:n}])},n.getLayer1GasFeeValue=async function({chainId:t,networkClientId:e,transactionParams:n}){return await(0,C.submitRequestToBackground)("getLayer1GasFee",[{chainId:t,networkClientId:e,transactionParams:n}])},n.getMarketingConsent=async function(){try{const t=await(0,C.submitRequestToBackground)("getMarketingConsent");return Boolean(t)}catch(t){return(0,M.logErrorWithMessage)((0,M.getErrorMessage)(t)),!1}},n.getNFTContractInfo=async function(t,e){return await(0,C.submitRequestToBackground)("getNFTContractInfo",[t,e])},n.getNetworkConfigurationByNetworkClientId=async function(t){let e;try{e=await(0,C.submitRequestToBackground)("getNetworkConfigurationByNetworkClientId",[t])}catch(t){console.error(t)}return e},n.getNetworksWithTransactionActivityByAccounts=function(){return async()=>{r.default.debug("background.getNetworksWithTransactionActivityByAccounts");try{return await(0,C.submitRequestToBackground)("getNetworksWithTransactionActivityByAccounts")}catch(t){throw(0,M.logErrorWithMessage)(t),new Error("Had a problem getting networks with activity by accounts!")}}},n.getNextAvailableAccountName=async function(t){return await(0,C.submitRequestToBackground)("getNextAvailableAccountName",[t])},n.getNextNonce=function(t,e){return async(n,a)=>{const r=e??(0,m.getSelectedNetworkClientId)(a());let o;try{o=await(0,C.submitRequestToBackground)("getNextNonce",[t,r])}catch(t){throw n(gt(t)),t}return n(pt(o)),o}},n.getOpenMetamaskTabsIds=function(){return async t=>{t(Et(await(0,C.submitRequestToBackground)("getOpenMetamaskTabsIds")))}},n.getPhishingResult=async function(t){return await(0,C.submitRequestToBackground)("getPhishingResult",[t])},n.getRequestAccountTabIds=function(){return async t=>{t(bt(await(0,C.submitRequestToBackground)("getRequestAccountTabIds")))}},n.getRpcMethodPreferences=function(){return async t=>{t(ct()),await(0,C.submitRequestToBackground)("getRpcMethodPreferences",[]),t(dt())}},n.getSeedPhrase=K,n.getSnapAccountsById=async function(t){return await(0,C.submitRequestToBackground)("getAccountsBySnapId",[t])},n.getSubscriptionCryptoApprovalAmount=async function(t){return await(0,C.submitRequestToBackground)("getSubscriptionCryptoApprovalAmount",[t])},n.getSubscriptionPricing=function(){return async t=>await(0,C.submitRequestToBackground)("getSubscriptionPricing")},n.getSubscriptions=function(){return async t=>await(0,C.submitRequestToBackground)("getSubscriptions")},n.getTokenStandardAndDetails=async function(t,e,n){return await(0,C.submitRequestToBackground)("getTokenStandardAndDetails",[t,e,n])},n.getTokenStandardAndDetailsByChain=async function(t,e,n,a){return await(0,C.submitRequestToBackground)("getTokenStandardAndDetailsByChain",[t,e,n,a])},n.getTokenSymbol=async function(t){return await(0,C.submitRequestToBackground)("getTokenSymbol",[t])},n.getTransactions=async function(t={}){return await(0,C.submitRequestToBackground)("getTransactions",[t])},n.getUserProfileLineage=async function(){try{return await(0,C.submitRequestToBackground)("getUserProfileLineage")}catch(t){return(0,M.logErrorWithMessage)(t),undefined}},n.goHome=F,n.handleSnapRequest=Y,n.hideAccountBanner=function(){return(0,C.submitRequestToBackground)("setShowAccountBanner",[!1])},n.hideAlert=function(){return{type:O.ALERT_CLOSE}},n.hideBetaHeader=function(){return(0,C.submitRequestToBackground)("setShowBetaHeader",[!1])},n.hideDeprecatedNetworkModal=function(){return{type:O.DEPRECATED_NETWORK_POPOVER_CLOSE}},n.hideImportNftsModal=function(){return{type:O.IMPORT_NFTS_MODAL_CLOSE}},n.hideImportTokensModal=function(){return{type:O.IMPORT_TOKENS_POPOVER_CLOSE}},n.hideIpfsModal=function(){return{type:O.SHOW_IPFS_MODAL_CLOSE}},n.hideKeyringRemovalResultModal=function(){return{type:O.HIDE_KEYRING_SNAP_REMOVAL_RESULT}},n.hideLoadingIndication=dt,n.hideModal=function(){return{type:O.MODAL_CLOSE}},n.hideNetworkBanner=function(){return(0,C.submitRequestToBackground)("setShowNetworkBanner",[!1])},n.hideNetworkDropdown=function(){return{type:O.NETWORK_DROPDOWN_CLOSE}},n.hideNftStillFetchingIndication=lt,n.hidePermissionsTour=function(){return(0,C.submitRequestToBackground)("setShowPermissionsTour",[!1])},n.hidePermittedNetworkToast=function(){return{type:O.SHOW_PERMITTED_NETWORK_TOAST_CLOSE}},n.hideTestNetMessage=function(){return(0,C.submitRequestToBackground)("setShowTestnetMessageInDropdown",[!1])},n.hideWarning=ft,n.ignoreTokens=function({tokensToIgnore:t,dontShowLoadingIndicator:e=!1,networkClientId:n=null}){const a=Array.isArray(t)?t:[t];return async t=>{e||t(ct());try{await(0,C.submitRequestToBackground)("ignoreTokens",[a,n])}catch(e){(0,M.logErrorWithMessage)(e),t(gt(e))}finally{await ht(t),t(dt())}}},n.importMnemonicToVault=function(t){return async e=>(e(ct()),r.default.debug("background.importMnemonicToVault"),new Promise((e,n)=>{(0,C.callBackgroundMethod)("importMnemonicToVault",[t],(t,a)=>{t?n(t):e(a)})}).then(async t=>(e(dt()),e(ft()),e((0,v.setShowNewSrpAddedToast)(!0)),t)).catch(t=>(e(gt(t)),e(dt()),Promise.reject(t))))},n.importNewAccount=function(t,e,n){return async a=>{a(ct(n));try{r.default.debug("background.importAccountWithStrategy"),await(0,C.submitRequestToBackground)("importAccountWithStrategy",[t,e])}finally{a(dt())}return await ht(a)}},n.isNftOwner=async function(t,e,n,a){return await(0,C.submitRequestToBackground)("isNftOwner",[t,e,n,a])},n.isRelaySupported=async function(t){return await(0,C.submitRequestToBackground)("isRelaySupported",[t])},n.isSendBundleSupported=async function(t){return await(0,C.submitRequestToBackground)("isSendBundleSupported",[t])},n.lockMetamask=function(t){return r.default.debug("background.setLocked"),e=>(e(ct(t)),et().then(()=>ht(e)).catch(t=>(e(gt((0,M.getErrorMessage)(t))),Promise.reject(t))).then(()=>{e(dt()),e({type:O.LOCK_METAMASK})}).catch(()=>{e(dt()),e({type:O.LOCK_METAMASK})}))},n.markMetamaskNotificationsAsRead=function(t){return async()=>{try{await(0,C.submitRequestToBackground)("markMetamaskNotificationsAsRead",[t])}catch(t){throw(0,M.logErrorWithMessage)(t),t}}},n.markPasswordForgotten=function(){return async t=>{try{await new Promise((t,e)=>{(0,C.callBackgroundMethod)("markPasswordForgotten",[],n=>{n?e(n):t()})})}finally{t(dt()),await ht(t)}}},n.multichainUpdateBalance=async function(t){return await(0,C.submitRequestToBackground)("multichainUpdateBalance",[t])},n.multichainUpdateTransactions=async function(t){return await(0,C.submitRequestToBackground)("multichainUpdateTransactions",[t])},n.openUpdateTabAndReload=async function(){return await(0,C.submitRequestToBackground)("openUpdateTabAndReload")},n.performSignIn=function(){return async()=>{try{await(0,C.submitRequestToBackground)("performSignIn")}catch(t){const e=t instanceof Error?t.message:"Unknown error occurred during sign-in.";throw(0,M.logErrorWithMessage)(e),t}}},n.performSignOut=function(){return async()=>{try{await(0,C.submitRequestToBackground)("performSignOut")}catch(t){throw(0,M.logErrorWithMessage)(t),t}}},n.qrCodeDetected=function(t){return async e=>{await e({type:O.QR_CODE_DETECTED,value:t}),e((0,y.computeEstimatedGasLimit)())}},n.rejectAllApprovals=function(){return async t=>{await(0,C.submitRequestToBackground)("rejectAllPendingApprovals");const{pendingApprovals:e}=await ht(t);0===Object.values(e).length&&t(it())}},n.rejectAllMessages=function(t){return async e=>{const n=(0,s.serializeError)(s.providerErrors.userRejectedRequest());await Promise.all(t.map(async({id:t})=>await(0,C.submitRequestToBackground)("rejectPendingApproval",[t,n])));const{pendingApprovals:a}=await ht(e);0===Object.values(a).length&&e(it())}},n.rejectPendingApproval=function(t,e){return async n=>{await(0,C.submitRequestToBackground)("rejectPendingApproval",[t,e]);const{pendingApprovals:a}=await ht(n);0===Object.values(a).length&&n(it())}},n.rejectPermissionsRequest=function(t){return e=>new Promise((n,a)=>{(0,C.callBackgroundMethod)("rejectPermissionsRequest",[t],t=>{if(t)return e(gt(t)),void a(t);ht(e).then(n).catch(a)})})},n.removeAccount=function(t){return async e=>{e(ct());try{await new Promise((e,n)=>{(0,C.callBackgroundMethod)("removeAccount",[t],(t,a)=>{t?n(t):e(a)})}),await ht(e)}catch(t){throw e(gt(t)),t}finally{e(dt())}r.default.info(`Account removed: ${t}`),e(at())}},n.removeAndIgnoreNft=function(t,e,n,a){return async r=>{if(!t)throw new Error("MetaMask - Cannot ignore NFT without address");if(!e)throw new Error("MetaMask - Cannot ignore NFT without tokenID");a||r(ct());try{await(0,C.submitRequestToBackground)("removeAndIgnoreNft",[t,e,n])}catch(t){throw(0,M.logErrorWithMessage)(t),r(gt(t)),t}finally{await ht(r),r(dt())}}},n.removeFromAddressBook=function(t,e){return r.default.debug("background.removeFromAddressBook"),async n=>{await(0,C.submitRequestToBackground)("removeFromAddressBook",[t,(0,k.toChecksumHexAddress)(e)]),await ht(n)}},n.removeNetwork=function(t){return async()=>{try{await(0,C.submitRequestToBackground)("removeNetwork",[t])}catch(t){(0,M.logErrorWithMessage)(t)}}},n.removeNft=function(t,e,n,a){return async r=>{if(!t)throw new Error("MetaMask - Cannot remove NFT without address");if(!e)throw new Error("MetaMask - Cannot remove NFT without tokenID");a||r(ct());try{await(0,C.submitRequestToBackground)("removeNft",[t,e,n])}catch(t){(0,M.logErrorWithMessage)(t),r(gt(t))}finally{await ht(r),r(dt())}}},n.removePermissionsFor=function(t){return e=>{(0,C.callBackgroundMethod)("removePermissionsFor",[t],t=>{t&&e(gt(t))})}},n.removePermittedAccount=function(t,e){return async n=>{await new Promise((n,a)=>{(0,C.callBackgroundMethod)("removePermittedAccount",[t,e],t=>{t?a(t):n()})}),await ht(n)}},n.removePermittedChain=function(t,e){return async n=>{await new Promise((n,a)=>{(0,C.callBackgroundMethod)("removePermittedChain",[t,e],t=>{t?a(t):n()})}),await ht(n)}},n.removePollingTokenFromAppState=Rt,n.removeSlide=function(t){return async()=>{try{await(0,C.submitRequestToBackground)("removeSlide",[t])}catch(t){throw(0,M.logErrorWithMessage)(t),t}}},n.removeSnap=function(t){return async(e,n)=>{var a;e(ct());const r=(null===(a=(0,w.getPermissionSubjects)(n())[t])||void 0===a||null===(a=a.permissions)||void 0===a?void 0:a.snap_manageAccounts)!==undefined;try{if(r){const e=await(0,C.submitRequestToBackground)("getAccountsBySnapId",[t]);for(const t of e)await(0,C.submitRequestToBackground)("removeAccount",[t])}await(0,C.submitRequestToBackground)("removeSnap",[t]),await ht(e)}catch(t){throw e(gt(t)),t}finally{e(dt())}}},n.requestAccountsAndChainPermissionsWithId=function(t){return async e=>{const n=await(0,C.submitRequestToBackground)("requestAccountsAndChainPermissionsWithId",[t]);return await ht(e),n}},n.requestRevealSeedWords=function(t,e){return async n=>{n(ct()),r.default.debug("background.verifyPassword");try{await x(t);return await K(t,e)}finally{n(dt())}}},n.requestSafeReload=async function(){return await(0,C.submitRequestToBackground)("requestSafeReload")},n.requestUserApproval=function({origin:t,type:e,requestData:n}){return async a=>{try{return await(0,C.submitRequestToBackground)("requestUserApproval",[{origin:t,type:e,requestData:n}])}catch(t){return(0,M.logErrorWithMessage)(t),a(gt("Had trouble requesting user approval")),null}}},n.resetAccount=function(){return t=>(t(ct()),new Promise((e,n)=>{(0,C.callBackgroundMethod)("resetAccount",[],(a,o)=>{if(t(dt()),a)return(0,M.isErrorWithMessage)(a)&&t(gt(a)),void n(a);r.default.info(`Transaction history reset for ${o}`),t(at()),e(o)})}))},n.resetBackgroundSwapsState=function(){return async t=>{await(0,C.submitRequestToBackground)("resetSwapsState"),await ht(t)}},n.resetOAuthLoginState=L,n.resetOnboarding=function(){return async(t,e)=>{try{const n=(0,w.getIsSocialLoginFlow)(e());t(yt()),n&&await t(L())}catch(t){console.error(t)}}},n.resetOnboardingAction=yt,n.resetSwapsPostFetchState=function(){return async t=>{await(0,C.submitRequestToBackground)("resetPostFetchState"),await ht(t)}},n.resetViewedNotifications=function(){return(0,C.submitRequestToBackground)("resetViewedNotifications")},n.resolvePendingApproval=function(t,e){return async n=>{await(0,C.submitRequestToBackground)("resolvePendingApproval",[t,e]);const{pendingApprovals:a}=await ht(n);0===Object.values(a).length&&n(it())}},n.restoreSocialBackupAndGetSeedPhrase=function(t){return async e=>{try{const n=await(0,C.submitRequestToBackground)("restoreSocialBackupAndGetSeedPhrase",[t]);return e(ft()),await ht(e),n}catch(t){throw r.default.error("[restoreSocialBackupAndGetSeedPhrase] error",t),e(gt(t.message)),t}}},n.restoreUserData=async function(t){try{await(0,C.submitRequestToBackground)("restoreUserData",[t])}catch(t){throw(0,M.logErrorWithMessage)(t),t}return!0},n.revokeDynamicSnapPermissions=function(t,e){return async n=>{await(0,C.submitRequestToBackground)("revokeDynamicSnapPermissions",[t,e]),await ht(n)}},n.rollbackToPreviousProvider=function(){return async t=>{try{await(0,C.submitRequestToBackground)("rollbackToPreviousProvider")}catch(e){(0,M.logErrorWithMessage)(e),t(gt("Had a problem changing networks!"))}}},n.safeRefetchQuotes=function(){return async t=>{await(0,C.submitRequestToBackground)("safeRefetchQuotes"),await ht(t)}},n.sendMultichainTransaction=async function(t,{account:e,scope:n,assetType:a}){await Y({snapId:t,origin:"metamask",handler:i.HandlerType.OnRpcRequest,request:{method:"startSendTransactionFlow",params:{account:e,scope:n,assetId:a}}})},n.setAccountDetailsAddress=function(t){return{type:O.SET_ACCOUNT_DETAILS_ADDRESS,payload:t}},n.setAccountGroupName=function(t,e){return async n=>{r.default.debug("background.setAccountGroupName");try{return await(0,C.submitRequestToBackground)("setAccountGroupName",[t,e]),await ht(n),!0}catch(t){return(0,M.logErrorWithMessage)(t),!1}}},n.setAccountLabel=function(t,e){return n=>(n(ct()),r.default.debug("background.setAccountLabel"),new Promise((a,r)=>{(0,C.callBackgroundMethod)("setAccountLabel",[t,e],o=>{if(n(dt()),o)return n(gt(o)),void r(o);n({type:O.SET_ACCOUNT_LABEL,value:{account:t,label:e}}),a(t)})}))},n.setActiveNetwork=function(t){return async e=>{r.default.debug(`background.setActiveNetwork: ${t}`);try{await(0,C.submitRequestToBackground)("setActiveNetwork",[t])}catch(t){(0,M.logErrorWithMessage)(t),e(gt("Had a problem changing networks!"))}}},n.setActiveNetworkConfigurationId=ot,n.setActiveNetworkWithError=function(t){return async e=>{r.default.debug(`background.setActiveNetwork: ${t}`);try{await(0,C.submitRequestToBackground)("setActiveNetwork",[t])}catch(t){throw(0,M.logErrorWithMessage)(t),e(gt("Had a problem changing networks!")),new Error("Had a problem changing networks!")}}},n.setAddSnapAccountEnabled=async function(t){try{await(0,C.submitRequestToBackground)("setAddSnapAccountEnabled",[t])}catch(t){(0,M.logErrorWithMessage)(t)}},n.setAdvancedGasFee=function(t){return e=>{e(ct()),r.default.debug("background.setAdvancedGasFee"),(0,C.callBackgroundMethod)("setAdvancedGasFee",[t],t=>{e(dt()),t&&e(gt(t))})}},n.setAlertEnabledness=async function(t,e){await(0,C.submitRequestToBackground)("setAlertEnabledness",[t,e])},n.setAutoLockTimeLimit=function(t){return wt("autoLockTimeLimit",t)},n.setAvatarType=function(t){return wt("avatarType",t)},n.setBackgroundSwapRouteState=function(t){return async e=>{await(0,C.submitRequestToBackground)("setBackgroundSwapRouteState",[t]),await ht(e)}},n.setCompletedOnboarding=function(){return async t=>{t(ct());try{await(0,C.submitRequestToBackground)("completeOnboarding"),t(mt())}catch(e){throw t(gt(e)),e}finally{t(dt())}}},n.setConfirmationAdvancedDetailsOpen=function(t){return wt("showConfirmationAdvancedDetails",t)},n.setConfirmationExchangeRates=function(t){return{type:O.SET_CONFIRMATION_EXCHANGE_RATES,value:t}},n.setConnectedStatusPopoverHasBeenShown=function(){return()=>{(0,C.callBackgroundMethod)("setConnectedStatusPopoverHasBeenShown",[],t=>{if((0,M.isErrorWithMessage)(t))throw new Error((0,M.getErrorMessage)(t))})}},n.setCurrentCurrency=function(t){return async e=>{e(ct()),r.default.debug("background.setCurrentCurrency");try{await(0,C.submitRequestToBackground)("setCurrentCurrency",[t]),await ht(e)}catch(t){return(0,M.logErrorWithMessage)(t),void e(gt(t))}finally{e(dt())}}},n.setCurrentExtensionPopupId=function(t){return async e=>{await(0,C.submitRequestToBackground)("setCurrentExtensionPopupId",[t]),await ht(e)}},n.setCurrentLocale=kt,n.setCustomApproveTxData=function(t){return async e=>{await(0,C.submitRequestToBackground)("setCustomApproveTxData",[t]),await ht(e)}},n.setDataCollectionForMarketing=function(t){return async e=>{r.default.debug("background.setDataCollectionForMarketing"),await(0,C.submitRequestToBackground)("setDataCollectionForMarketing",[t]),e({type:O.SET_DATA_COLLECTION_FOR_MARKETING,value:t})}},n.setDefaultHomeActiveTabName=function(t){return async e=>{await(0,C.submitRequestToBackground)("setDefaultHomeActiveTabName",[t]),await ht(e)}},n.setDismissSeedBackUpReminder=function(t){return async e=>{e(ct()),await(0,C.submitRequestToBackground)("setDismissSeedBackUpReminder",[t]),e(dt())}},n.setDismissSmartAccountSuggestionEnabled=function(t){return async(e,n)=>{const a=(0,q.getDismissSmartAccountSuggestionEnabled)(n());Bt({category:b.MetaMetricsEventCategory.Settings,event:b.MetaMetricsEventName.SettingsUpdated,properties:{dismiss_smt_acc_suggestion_enabled:t,prev_dismiss_smt_acc_suggestion_enabled:a}}),await e(wt("dismissSmartAccountSuggestionEnabled",t)),await ht(e)}},n.setEditedNetwork=function(t=undefined){return{type:O.SET_EDIT_NETWORK,payload:t}},n.setEnableEnforcedSimulationsForTransaction=async function(t,e){try{await(0,C.submitRequestToBackground)("setEnableEnforcedSimulationsForTransaction",[t,e])}catch(t){throw(0,M.logErrorWithMessage)(t),t}},n.setEnabledNetworks=function(t,e){return async()=>{await(0,C.submitRequestToBackground)("setEnabledNetworks",[t,e])}},n.setEnabledNetworksMultichain=function(t,e){return async()=>{await(0,C.submitRequestToBackground)("setEnabledNetworksMultichain",[t,e])}},n.setEnforcedSimulationsSlippageForTransaction=async function(t,e){try{await(0,C.submitRequestToBackground)("setEnforcedSimulationsSlippageForTransaction",[t,e])}catch(t){throw(0,M.logErrorWithMessage)(t),t}},n.setFeatureAnnouncementsEnabled=function(t){return async()=>{try{await(0,C.submitRequestToBackground)("setFeatureAnnouncementsEnabled",[t])}catch(t){throw(0,M.logErrorWithMessage)(t),t}}},n.setFeatureFlag=function(t,e,n){return a=>(a(ct()),new Promise((r,o)=>{(0,C.callBackgroundMethod)("setFeatureFlag",[t,e],(t,e)=>{if(a(dt()),t)return a(gt(t)),void o(t);n&&a(st({name:n})),r(e)})}))},n.setFeatureNotificationsEnabled=function(t){return wt("featureNotificationsEnabled",t)},n.setFirstTimeFlowType=function(t){return async e=>{try{r.default.debug("background.setFirstTimeFlowType"),await(0,C.submitRequestToBackground)("setFirstTimeFlowType",[t]),e({type:O.SET_FIRST_TIME_FLOW_TYPE,value:t})}catch(t){e(gt(t))}}},n.setHardwareWalletDefaultHdPath=function({device:t,path:e}){return{type:O.SET_HARDWARE_WALLET_DEFAULT_HD_PATH,payload:{device:t,path:e}}},n.setHideZeroBalanceTokens=function(t){return wt("hideZeroBalanceTokens",t)},n.setInitialGasEstimate=function(t){return async e=>{await(0,C.submitRequestToBackground)("setInitialGasEstimate",[t]),await ht(e)}},n.setIpfsGateway=function(t){return e=>{r.default.debug("background.setIpfsGateway"),(0,C.callBackgroundMethod)("setIpfsGateway",[t],t=>{t&&e(gt(t))})}},n.setIsBackupAndSyncFeatureEnabled=function(t,e){return async()=>{try{await(0,C.submitRequestToBackground)("setIsBackupAndSyncFeatureEnabled",[t,e])}catch(t){throw(0,M.logErrorWithMessage)(t),t}}},n.setIsIpfsGatewayEnabled=function(t){return e=>{r.default.debug("background.setIsIpfsGatewayEnabled"),(0,C.callBackgroundMethod)("setIsIpfsGatewayEnabled",[t],t=>{t&&e(gt(t))})}},n.setIsSocialLoginFlowEnabledForMetrics=function(t){return async e=>{await(0,C.submitRequestToBackground)("setIsSocialLoginFlowEnabledForMetrics",[t]),e({type:O.SET_IS_SOCIAL_LOGIN_FLOW_ENABLED_FOR_METRICS,value:t})}},n.setLastActiveTime=function(){return t=>{(0,C.callBackgroundMethod)("setLastActiveTime",[],e=>{e&&t(gt(e))})}},n.setLastInteractedConfirmationInfo=async function(t){return await(0,C.submitRequestToBackground)("setLastInteractedConfirmationInfo",[t])},n.setLastViewedUserSurvey=function(t){return async()=>{await(0,C.submitRequestToBackground)("setLastViewedUserSurvey",[t])}},n.setManageInstitutionalWallets=function(t){return async e=>{e(ct()),await(0,C.submitRequestToBackground)("setManageInstitutionalWallets",[t]),e(dt())}},n.setMarketingConsent=function(t){return async()=>{try{const e=await(0,C.submitRequestToBackground)("setMarketingConsent",[t]);return Boolean(e)}catch(t){return(0,M.logErrorWithMessage)((0,M.getErrorMessage)(t)),!1}}},n.setName=function(t){return async()=>{await(0,C.submitRequestToBackground)("setName",[t])}},n.setNetworkClientIdForDomain=function(t,e){return(0,C.submitRequestToBackground)("setNetworkClientIdForDomain",[t,e])},n.setNewNetworkAdded=function({networkConfigurationId:t,nickname:e}){return{type:O.SET_NEW_NETWORK_ADDED,payload:{networkConfigurationId:t,nickname:e}}},n.setNewNftAddedMessage=function(t){return{type:O.SET_NEW_NFT_ADDED_MESSAGE,payload:t}},n.setNewTokensImported=function(t){return{type:O.SET_NEW_TOKENS_IMPORTED,payload:t}},n.setNewTokensImportedError=function(t){return{type:O.SET_NEW_TOKENS_IMPORTED_ERROR,payload:t}},n.setNextNonce=pt,n.setOpenMetamaskTabsIDs=Et,n.setOpenSeaEnabled=function(t){return async e=>{e(ct()),r.default.debug("background.setOpenSeaEnabled");try{await(0,C.submitRequestToBackground)("setOpenSeaEnabled",[t])}finally{e(dt())}}},n.setOutdatedBrowserWarningLastShown=function(t){return async()=>{await(0,C.submitRequestToBackground)("setOutdatedBrowserWarningLastShown",[t])}},n.setOverrideContentSecurityPolicyHeader=function(t){return async e=>{e(ct()),await(0,C.submitRequestToBackground)("setOverrideContentSecurityPolicyHeader",[t]),e(dt())}},n.setParticipateInMetaMetrics=function(t){return e=>(r.default.debug("background.setParticipateInMetaMetrics"),new Promise((n,a)=>{(0,C.callBackgroundMethod)("setParticipateInMetaMetrics",[t],(o,s)=>{if(r.default.debug(o),o)return e(gt(o)),void a(o);e({type:O.SET_PARTICIPATE_IN_METAMETRICS,value:t}),n([t,s])})}))},n.setPendingTokens=function(t){const{customToken:e,selectedTokens:n={},tokenAddressList:a=[]}=t,r=null!=e&&e.address&&null!=e&&e.symbol&&Boolean((null==e?void 0:e.decimals)>=0&&(null==e?void 0:e.decimals)<=36)?{...n,[e.address]:{...e,isCustom:!0}}:n;return Object.keys(r).forEach(t=>{const e=a.find(e=>(0,S.isEqualCaseInsensitive)(e,t));r[t]={...r[t],unlisted:!e}}),{type:O.SET_PENDING_TOKENS,payload:r}},n.setPermittedAccounts=function(t,e){return async n=>{await new Promise((n,a)=>{(0,C.callBackgroundMethod)("setPermittedAccounts",[t,e],t=>{t?a(t):n()})}),await ht(n)}},n.setPermittedChains=function(t,e){return async n=>{await new Promise((n,a)=>{(0,C.callBackgroundMethod)("setPermittedChains",[t,e],t=>{t?a(t):n()})}),await ht(n)}},n.setPreference=wt,n.setPrivacyMode=function(t){return wt("privacyMode",t,!1)},n.setRecoveryPhraseReminderHasBeenShown=function(){return()=>{(0,C.callBackgroundMethod)("setRecoveryPhraseReminderHasBeenShown",[],t=>{if((0,M.isErrorWithMessage)(t))throw new Error((0,M.getErrorMessage)(t))})}},n.setRecoveryPhraseReminderLastShown=function(t){return()=>{(0,C.callBackgroundMethod)("setRecoveryPhraseReminderLastShown",[t],t=>{if((0,M.isErrorWithMessage)(t))throw new Error((0,M.getErrorMessage)(t))})}},n.setRemoveNftMessage=function(t){return{type:O.SET_REMOVE_NFT_MESSAGE,payload:t}},n.setRequestAccountTabIds=bt,n.setSecurityAlertsEnabled=function(t){try{(0,C.submitRequestToBackground)("setSecurityAlertsEnabled",[t])}catch(t){(0,M.logErrorWithMessage)(t)}},n.setSeedPhraseBackedUp=function(t){return e=>(r.default.debug("background.setSeedPhraseBackedUp"),new Promise((n,a)=>{(0,C.callBackgroundMethod)("setSeedPhraseBackedUp",[t],t=>{if(t)return e(gt(t)),void a(t);ht(e).then(n).catch(a)})}))},n.setSelectedAccount=function(t){return async(e,n)=>{e(ct()),r.default.debug("background.setSelectedAccount");const a=n(),o=(0,T.getUnconnectedAccountAlertEnabledness)(a),s=a.activeTab.origin,i=(0,w.getSelectedInternalAccount)(a),c=(0,w.getInternalAccountByAddress)(a,t),d=(0,w.getAllPermittedAccountsForCurrentTab)(a),l=(0,u.isInternalAccountInPermittedAccountIds)(i,d),g=(0,u.isInternalAccountInPermittedAccountIds)(c,d),f=Boolean(s)&&l&&!g;try{await nt(c.id),await ht(e)}catch(t){return void e(gt(t))}finally{e(dt())}o&&f&&(e((0,h.switchedToUnconnectedAccount)()),await Mt(s))}},n.setSelectedInternalAccount=function(t){return async e=>{e(ct()),r.default.debug("background.setSelectedInternalAccount");try{await nt(t)}catch(t){return void e(gt(t))}finally{e(dt())}}},n.setSelectedInternalAccountWithoutLoading=function(t){return async e=>{try{await nt(t),await ht(e)}catch(t){e(gt(t))}}},n.setSelectedMultichainAccount=function(t){return async(e,n)=>{r.default.debug("background.setSelectedMultichainAccount");try{e(ct()),await(0,C.submitRequestToBackground)("setSelectedMultichainAccount",[t]),await ht(e)}catch(t){(0,M.logErrorWithMessage)(t)}finally{e(dt())}}},n.setSelectedNetworkConfigurationId=function(t){return{type:O.SET_SELECTED_NETWORK_CONFIGURATION_ID,payload:t}},n.setSelectedQuoteAggId=function(t){return async e=>{await(0,C.submitRequestToBackground)("setSelectedQuoteAggId",[t]),await ht(e)}},n.setServiceWorkerKeepAlivePreference=function(t){return async e=>{e(ct()),r.default.debug("background.setServiceWorkerKeepAlivePreference");try{await(0,C.submitRequestToBackground)("setServiceWorkerKeepAlivePreference",[t])}catch(t){e(gt(t))}finally{e(dt())}}},n.setShowConnectionsRemovedModal=J,n.setShowExtensionInFullSizeView=function(t){return wt("showExtensionInFullSizeView",t)},n.setShowFiatConversionOnTestnetsPreference=function(t){return wt("showFiatInTestnets",t)},n.setShowMultiRpcModal=function(t){return wt("showMultiRpcModal",t)},n.setShowNativeTokenAsMainBalancePreference=function(t){return wt("showNativeTokenAsMainBalance",t)},n.setShowSupportDataConsentModal=function(t){return{type:O.SET_SHOW_SUPPORT_DATA_CONSENT_MODAL,payload:t}},n.setShowTestNetworks=function(t){return wt("showTestNetworks",t)},n.setSkipDeepLinkInterstitial=function(t){return wt("skipDeepLinkInterstitial",t,!1)},n.setSlides=function(t){return{type:O.SET_SLIDES,slides:t}},n.setSmartAccountOptIn=function(t){return async(e,n)=>{const a=(0,q.getUseSmartAccount)(n());Bt({category:b.MetaMetricsEventCategory.Settings,event:b.MetaMetricsEventName.SettingsUpdated,properties:{use_smart_account:t,prev_use_smart_account:a}}),await e(wt("smartAccountOptIn",t)),await ht(e)}},n.setSmartTransactionsPreferenceEnabled=function(t){return async(e,n)=>{const a=(0,R.getSmartTransactionsOptInStatusInternal)(n());Bt({category:b.MetaMetricsEventCategory.Settings,event:b.MetaMetricsEventName.SettingsUpdated,properties:{stx_opt_in:t,prev_stx_opt_in:a}}),await e(wt("smartTransactionsOptInStatus",t)),await ht(e)}},n.setSmartTransactionsRefreshInterval=function(t){return async()=>{if(t!==undefined&&null!==t)try{await(0,C.submitRequestToBackground)("setStatusRefreshInterval",[t])}catch(t){(0,M.logErrorWithMessage)(t)}}},n.setSnapsAddSnapAccountModalDismissed=async function(){await(0,C.submitRequestToBackground)("setSnapsAddSnapAccountModalDismissed",[!0])},n.setSnapsInstallPrivacyWarningShownStatus=function(t){return async()=>{await(0,C.submitRequestToBackground)("setSnapsInstallPrivacyWarningShownStatus",[t])}},n.setSwapsErrorKey=function(t){return async e=>{await(0,C.submitRequestToBackground)("setSwapsErrorKey",[t]),await ht(e)}},n.setSwapsFeatureFlags=function(t){return async e=>{await(0,C.submitRequestToBackground)("setSwapsFeatureFlags",[t]),await ht(e)}},n.setSwapsLiveness=function(t){return async e=>{await(0,C.submitRequestToBackground)("setSwapsLiveness",[t]),await ht(e)}},n.setSwapsQuotesPollingLimitEnabled=function(t){return async e=>{await(0,C.submitRequestToBackground)("setSwapsQuotesPollingLimitEnabled",[t]),await ht(e)}},n.setSwapsTokens=function(t){return async e=>{await(0,C.submitRequestToBackground)("setSwapsTokens",[t]),await ht(e)}},n.setSwapsTxGasLimit=function(t){return async e=>{await(0,C.submitRequestToBackground)("setSwapsTxGasLimit",[t,!0]),await ht(e)}},n.setSwapsTxGasPrice=function(t){return async e=>{await(0,C.submitRequestToBackground)("setSwapsTxGasPrice",[t]),await ht(e)}},n.setTermsOfUseLastAgreed=function(t){return async()=>{await(0,C.submitRequestToBackground)("setTermsOfUseLastAgreed",[t])}},n.setTheme=function(t){return async e=>{e(ct()),r.default.debug("background.setTheme");try{await(0,C.submitRequestToBackground)("setTheme",[t])}finally{e(dt())}}},n.setTokenNetworkFilter=function(t){return wt("tokenNetworkFilter",t,!1)},n.setTokenSortConfig=function(t){return wt("tokenSortConfig",t,!1)},n.setTransactionActive=function(t,e){return async()=>{await(0,C.submitRequestToBackground)("setTransactionActive",[t,e])}},n.setUnconnectedAccountAlertShown=Mt,n.setUpdateModalLastDismissedAt=async function(t){await(0,C.submitRequestToBackground)("setUpdateModalLastDismissedAt",[t])},n.setUse4ByteResolution=function(t){return async e=>{e(ct()),r.default.debug("background.setUse4ByteResolution");try{await(0,C.submitRequestToBackground)("setUse4ByteResolution",[t])}catch(t){e(gt(t))}finally{e(dt())}}},n.setUseAddressBarEnsResolution=function(t){return e=>{r.default.debug("background.setUseAddressBarEnsResolution"),(0,C.callBackgroundMethod)("setUseAddressBarEnsResolution",[t],t=>{t&&e(gt(t))})}},n.setUseBlockie=function(t){return e=>{e(ct()),r.default.debug("background.setUseBlockie"),(0,C.callBackgroundMethod)("setUseBlockie",[t],t=>{e(dt()),t&&e(gt(t))})}},n.setUseCurrencyRateCheck=function(t){return e=>{e(ct()),r.default.debug("background.setUseCurrencyRateCheck"),(0,C.callBackgroundMethod)("setUseCurrencyRateCheck",[t],t=>{e(dt()),t&&e(gt(t))})}},n.setUseExternalNameSources=function(t){try{(0,C.submitRequestToBackground)("setUseExternalNameSources",[t])}catch(t){(0,M.logErrorWithMessage)(t)}},n.setUseMultiAccountBalanceChecker=function(t){return e=>{e(ct()),r.default.debug("background.setUseMultiAccountBalanceChecker"),(0,C.callBackgroundMethod)("setUseMultiAccountBalanceChecker",[t],t=>{e(dt()),t&&e(gt(t))})}},n.setUseNftDetection=function(t){return async e=>{e(ct()),r.default.debug("background.setUseNftDetection");try{await(0,C.submitRequestToBackground)("setUseNftDetection",[t])}finally{e(dt())}}},n.setUsePhishDetect=function(t){return e=>{e(ct()),r.default.debug("background.setUsePhishDetect"),(0,C.callBackgroundMethod)("setUsePhishDetect",[t],t=>{e(dt()),t&&e(gt(t))})}},n.setUseSafeChainsListValidation=function(t){return e=>{e(ct()),r.default.debug("background.setUseSafeChainsListValidation"),(0,C.callBackgroundMethod)("setUseSafeChainsListValidation",[t],t=>{e(dt()),t&&e(gt(t))})}},n.setUseTokenDetection=function(t){return e=>{e(ct()),r.default.debug("background.setUseTokenDetection"),(0,C.callBackgroundMethod)("setUseTokenDetection",[t],t=>{e(dt()),t&&e(gt(t))})}},n.setUseTransactionSimulations=function(t){try{(0,C.submitRequestToBackground)("setUseTransactionSimulations",[t])}catch(t){(0,M.logErrorWithMessage)(t)}},n.setWatchEthereumAccountEnabled=async function(t){try{await(0,C.submitRequestToBackground)("setWatchEthereumAccountEnabled",[t])}catch(t){(0,M.logErrorWithMessage)(t)}},n.setWeb3ShimUsageAlertDismissed=async function(t){await(0,C.submitRequestToBackground)("setWeb3ShimUsageAlertDismissed",[t])},n.showAccountsPage=at,n.showAlert=function(t){return{type:O.ALERT_OPEN,payload:t}},n.showConfTxPage=rt,n.showConfirmTurnOnMetamaskNotifications=function(){return t=>{t(st({name:"TURN_ON_METAMASK_NOTIFICATIONS"}))}},n.showDeprecatedNetworkModal=function(){return{type:O.DEPRECATED_NETWORK_POPOVER_OPEN}},n.showImportNftsModal=function(t){return{type:O.IMPORT_NFTS_MODAL_OPEN,payload:t}},n.showImportTokensModal=function(){return{type:O.IMPORT_TOKENS_POPOVER_OPEN}},n.showIpfsModal=function(){return{type:O.SHOW_IPFS_MODAL_OPEN}},n.showKeyringSnapRemovalModal=function(t){return{type:O.SHOW_KEYRING_SNAP_REMOVAL_RESULT,payload:t}},n.showLoadingIndication=ct,n.showModal=st,n.showNetworkDropdown=function(){return{type:O.NETWORK_DROPDOWN_OPEN}},n.showNftStillFetchingIndication=ut,n.showPermittedNetworkToast=function(){return{type:O.SHOW_PERMITTED_NETWORK_TOAST_OPEN}},n.showPrivateKey=function(t){return{type:O.SHOW_PRIVATE_KEY,payload:t}},n.showQrScanner=function(){return t=>{t(st({name:"QR_SCANNER"}))}},n.showSendTokenPage=function(){return{type:O.SHOW_SEND_TOKEN_PAGE}},n.signAndSendSmartTransaction=function({unsignedTransaction:t,smartTransactionFees:e}){return async n=>{const a=await Pt(t,e.fees);try{return(await(0,C.submitRequestToBackground)("submitSignedTransactions",[{signedTransactions:a,signedCanceledTransactions:[],txParams:t}])).uuid}catch(t){if((0,M.logErrorWithMessage)(t),(0,M.isErrorWithMessage)(t)){const e=(0,M.getErrorMessage)(t);if(e.startsWith("Fetch error:")){const t=(0,E.parseSmartTransactionsError)(e);n({type:O.SET_SMART_TRANSACTIONS_ERROR,payload:t})}}throw t}}},n.startOAuthLogin=function(t,e,n){return async a=>{a(ct());try{const a=await(0,C.submitRequestToBackground)("startOAuthLogin",[t]);let r=!1,o=!1;try{null==e||e({name:N.TraceName.OnboardingOAuthSeedlessAuthenticate,op:N.TraceOperation.OnboardingSecurityOp}),({isNewUser:o}=await(0,C.submitRequestToBackground)("authenticate",[a])),r=!0}catch(t){const a=t instanceof Error?t.message:"Unknown error";throw null==e||e({name:N.TraceName.OnboardingOAuthSeedlessAuthenticateError,op:N.TraceOperation.OnboardingError,tags:{errorMessage:a}}),null==n||n({name:N.TraceName.OnboardingOAuthSeedlessAuthenticateError}),t}finally{null==n||n({name:N.TraceName.OnboardingOAuthSeedlessAuthenticate,data:{success:r}})}return o}catch(t){throw a(gt(t)),(0,M.isErrorWithMessage)(t)?new Error((0,M.getErrorMessage)(t)):t}finally{a(dt())}}},n.startSubscriptionWithCard=function(t){return async e=>await(0,C.submitRequestToBackground)("startSubscriptionWithCard",[t])},n.stopPollingForQuotes=function(){return async t=>{await(0,C.submitRequestToBackground)("stopPollingForQuotes"),await ht(t)}},n.storeKeyringEncryptionKey=function(t){return(0,C.submitRequestToBackground)("storeKeyringEncryptionKey",[t])},n.submitPassword=U,n.syncAccountTreeWithUserStorage=function(){return async()=>{try{return await(0,C.submitRequestToBackground)("syncAccountTreeWithUserStorage")}catch(t){throw(0,M.logErrorWithMessage)(t),t}}},n.syncContactsWithUserStorage=function(){return async()=>{try{return await(0,C.submitRequestToBackground)("syncContactsWithUserStorage")}catch(t){throw(0,M.logErrorWithMessage)(t),t}}},n.syncSeedPhrases=function(){return async t=>{try{await(0,C.submitRequestToBackground)("syncSeedPhrases"),t(ft()),await ht(t)}catch(e){throw r.default.error("[syncSeedPhrases] error",e),t(gt(e.message)),e}}},n.throwTestBackgroundError=async function(t){await(0,C.submitRequestToBackground)("throwTestError",[t])},n.toggleAccountMenu=function(){return{type:O.TOGGLE_ACCOUNT_MENU}},n.toggleExternalServices=function(t){return async e=>{r.default.debug("background.toggleExternalServices");try{await(0,C.submitRequestToBackground)("toggleExternalServices",[t]),await ht(e)}catch(t){e(gt(t))}}},n.toggleNetworkMenu=function(t){return{type:O.TOGGLE_NETWORK_MENU,payload:t}},n.tokenBalancesStartPolling=async function(t){const e=await(0,C.submitRequestToBackground)("tokenBalancesStartPolling",[{chainIds:t}]);return await St(e),e},n.tokenBalancesStopPollingByPollingToken=async function(t){await(0,C.submitRequestToBackground)("tokenBalancesStopPollingByPollingToken",[t]),await Rt(t)},n.tokenDetectionStartPolling=async function(t){const e=await(0,C.submitRequestToBackground)("tokenDetectionStartPolling",[{chainIds:t}]);return await St(e),e},n.tokenDetectionStopPollingByPollingToken=async function(t){await(0,C.submitRequestToBackground)("tokenDetectionStopPollingByPollingToken",[t]),await Rt(t)},n.tokenListStartPolling=async function(t){const e=await(0,C.submitRequestToBackground)("tokenListStartPolling",[{chainId:t}]);return await St(e),e},n.tokenListStopPollingByPollingToken=async function(t){await(0,C.submitRequestToBackground)("tokenListStopPollingByPollingToken",[t]),await Rt(t)},n.tokenRatesStartPolling=async function(t){const e=await(0,C.submitRequestToBackground)("tokenRatesStartPolling",[{chainIds:t}]);return await St(e),e},n.tokenRatesStopPollingByPollingToken=async function(t){await(0,C.submitRequestToBackground)("tokenRatesStopPollingByPollingToken",[t]),await Rt(t)},n.trackInsightSnapUsage=function(t){return async()=>{await(0,C.submitRequestToBackground)("trackInsightSnapView",[t])}},n.trackMetaMetricsEvent=Bt,n.trackMetaMetricsPage=function(t,e){return(0,C.submitRequestToBackground)("trackMetaMetricsPage",[{...t,actionId:(0,C.generateActionId)()},e])},n.tryReverseResolveAddress=function(t){return()=>new Promise(e=>{(0,C.callBackgroundMethod)("tryReverseResolveAddress",[t],t=>{t&&(0,M.logErrorWithMessage)(t),e()})})},n.tryUnlockMetamask=function(t){return e=>(e(ct()),e(z()),r.default.debug("background.syncPasswordAndUnlockWallet"),new Promise((n,a)=>{(0,C.callBackgroundMethod)("syncPasswordAndUnlockWallet",[t],(t,r)=>{t?a(t):(r||e(J(!0)),n())})}).then(()=>(e(Z()),ht(e))).then(()=>{e(dt()),e(ft())}).catch(t=>(e(X((0,M.getErrorMessage)(t))),e(dt()),Promise.reject(t))))},n.unMarkPasswordForgotten=$,n.unlockAndGetSeedPhrase=function(t){return async e=>{try{await U(t);const n=await K(t);return await ht(e),n}catch(t){throw e(gt(t)),(0,M.isErrorWithMessage)(t)?new Error((0,M.getErrorMessage)(t)):t}}},n.unlockFailed=X,n.unlockHardwareWalletAccounts=function(t,e,n,a){return r.default.debug("background.unlockHardwareWalletAccount",t,e,n,a),async r=>{r(ct());for(const o of t)try{await(0,C.submitRequestToBackground)("unlockHardwareWalletAccount",[o,e,n,a])}catch(t){throw(0,M.logErrorWithMessage)(t),r(gt(t)),r(dt()),t}return r(dt()),undefined}},n.unlockInProgress=z,n.unlockSucceeded=Z,n.updateAccountsList=function(t){return async()=>{await(0,C.submitRequestToBackground)("updateAccountsList",[t])}},n.updateAndApproveTx=function(t,e,n){return(a,r)=>{!e&&a(ct(n));const o=()=>Boolean(r().send.stage!==y.SEND_STAGES.INACTIVE);return new Promise((e,n)=>{const r=(0,C.generateActionId)();(0,C.callBackgroundMethod)("resolvePendingApproval",[String(t.id),{txMeta:t,actionId:r},{waitForResult:!0}],r=>{if(a(Q(t.id,t.txParams)),o()||a((0,y.resetSendState)()),r)return a(F()),(0,M.logErrorWithMessage)(r),void n(r);e(t)})}).then(()=>ht(a)).then(()=>(o()||a((0,y.resetSendState)()),a(j(t.id)),a(dt()),a(V("")),a(it()),t)).catch(t=>(a(dt()),Promise.reject(t)))}},n.updateCurrentLocale=Tt,n.updateCustomNonce=V,n.updateCustomSwapsEIP1559GasParams=function({gasLimit:t,maxFeePerGas:e,maxPriorityFeePerGas:n}){return async a=>{await Promise.all([(0,C.submitRequestToBackground)("setSwapsTxGasLimit",[t]),(0,C.submitRequestToBackground)("setSwapsTxMaxFeePerGas",[e]),(0,C.submitRequestToBackground)("setSwapsTxMaxFeePriorityPerGas",[n])]),await ht(a)}},n.updateDataDeletionTaskStatus=async function(){return await(0,C.submitRequestToBackground)("updateDataDeletionTaskStatus")},n.updateEditableParams=function(...t){return async e=>{let n;try{n=await(0,C.submitRequestToBackground)("updateEditableParams",t)}catch(t){throw(0,M.logErrorWithMessage)(t),t}return await ht(e),n}},n.updateEventFragment=function(t,e){return(0,C.submitRequestToBackground)("updateEventFragment",[t,e])},n.updateHiddenAccountsList=function(t){return async()=>{await(0,C.submitRequestToBackground)("updateHiddenAccountsList",[t])}},n.updateIncomingTransactions=function(){return async t=>{r.default.debug("background.updateIncomingTransactions");try{await(0,C.submitRequestToBackground)("updateIncomingTransactions")}catch(e){(0,M.logErrorWithMessage)(e),t(gt("Had a problem updating incoming transactions!"))}}},n.updateInterfaceState=function(t,e){return async n=>{await(0,C.submitRequestToBackground)("updateInterfaceState",[t,e]),await ht(n)}},n.updateMetamaskState=tt,n.updateNetwork=function(t,e={}){return async n=>{r.default.debug("background.updateNetwork",t);try{return await(0,C.submitRequestToBackground)("updateNetwork",[t.chainId,t,e])}catch(t){(0,M.logErrorWithMessage)(t),n(gt("Had a problem updading networks!"))}return undefined}},n.updateNetworksList=function(t){return async()=>{await(0,C.submitRequestToBackground)("updateNetworksList",[t])}},n.updateNftDropDownState=function(t){return async e=>{await(0,C.submitRequestToBackground)("updateNftDropDownState",[t]),await ht(e)}},n.updatePreviousGasParams=function(t,e){return async()=>{let n;try{n=await(0,C.submitRequestToBackground)("updatePreviousGasParams",[t,e])}catch(t){throw(0,M.logErrorWithMessage)(t),t}return n}},n.updateProposedNames=function(t){return async()=>await(0,C.submitRequestToBackground)("updateProposedNames",[t])},n.updateSlides=function(t){return async()=>{try{await(0,C.submitRequestToBackground)("updateSlides",[t])}catch(t){throw(0,M.logErrorWithMessage)(t),t}}},n.updateSmartTransaction=function(t,e){return async n=>{try{await(0,C.submitRequestToBackground)("updateSmartTransaction",[{uuid:t,...e}])}catch(t){if((0,M.logErrorWithMessage)(t),(0,M.isErrorWithMessage)(t)){const e=(0,M.getErrorMessage)(t);if(e.startsWith("Fetch error:")){const t=(0,E.parseSmartTransactionsError)(e);n({type:O.SET_SMART_TRANSACTIONS_ERROR,payload:t})}}throw t}}},n.updateSnap=function(t,e){return async(n,a)=>{await(0,C.submitRequestToBackground)("updateSnap",[t,e]),await ht(n);const r=a(),o=(0,w.getFirstSnapInstallOrUpdateRequest)(r);return null==o?void 0:o.metadata.id}},n.updateSwapsUserFeeLevel=function(t){return async e=>{await(0,C.submitRequestToBackground)("setSwapsUserFeeLevel",[t]),await ht(e)}},n.updateThrottledOriginState=function(t,e){return async()=>{await(0,C.submitRequestToBackground)("updateThrottledOriginState",[t,e])}},n.updateTokenType=async function(t){try{return await(0,C.submitRequestToBackground)("updateTokenType",[t])}catch(t){(0,M.logErrorWithMessage)(t)}return undefined},n.updateTransaction=function(t,e){return async n=>{!e&&n(ct());try{await(0,C.submitRequestToBackground)("updateTransaction",[t])}catch(e){throw n(Q(t.id,t.txParams)),n(dt()),n(F()),(0,M.logErrorWithMessage)(e),e}try{return n(Q(t.id,t.txParams)),await ht(n),n(rt({id:t.id})),t}finally{n(dt())}}},n.updateTransactionGasFees=function(t,e){return async()=>{let n;try{n=await(0,C.submitRequestToBackground)("updateTransactionGasFees",[t,e])}catch(t){throw(0,M.logErrorWithMessage)(t),t}return n}},n.updateTransactionParams=Q,n.updateTransactionSendFlowHistory=function(t,e,n){return async()=>{let a;try{a=await(0,C.submitRequestToBackground)("updateTransactionSendFlowHistory",[t,e,n])}catch(t){throw(0,M.logErrorWithMessage)(t),t}return a}},n.updateViewedNotifications=function(t){return(0,C.submitRequestToBackground)("updateViewedNotifications",[t])},n.verifyPassword=x;var a=W(t("webextension-polyfill")),r=W(t("loglevel")),o=t("lodash"),s=t("@metamask/rpc-errors"),i=t("@metamask/snaps-utils"),c=t("@metamask/account-tree-controller"),u=t("@metamask/chain-agnostic-permission"),d=t("../../shared/lib/sentry"),l=t("../../shared/lib/switch-direction"),g=t("../../shared/constants/app"),f=t("../../app/scripts/lib/util"),w=t("../selectors"),m=t("../../shared/modules/selectors/networks"),y=t("../ducks/send"),h=t("../ducks/alerts/unconnected-account"),T=t("../ducks/metamask/metamask"),k=t("../../shared/modules/hexstring-utils"),p=t("../../shared/constants/hardware-wallets"),b=t("../../shared/constants/metametrics"),E=t("../pages/swaps/swaps.util"),S=t("../../shared/modules/string-utils"),R=t("../../shared/modules/selectors"),A=t("../../shared/modules/i18n"),B=t("../../shared/modules/conversion.utils"),M=t("../../shared/modules/error"),P=t("../../shared/lib/four-byte"),N=t("../../shared/lib/trace"),I=t("../helpers/constants/notifications"),q=t("../pages/confirmations/selectors/preferences"),v=t("../components/app/toast-master/utils"),_=t("../hooks/multichain-accounts/utils"),O=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=D(e);if(n&&n.has(t))return n.get(t);var a={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&{}.hasOwnProperty.call(t,o)){var s=r?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(a,o,s):a[o]=t[o]}return a.default=t,n&&n.set(t,a),a}(t("./actionConstants")),C=t("./background-connection");function D(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(D=function(t){return t?n:e})(t)}function W(t){return t&&t.__esModule?t:{default:t}}function F(){return{type:O.GO_HOME}}function L(){return async t=>{t(ct());try{await(0,C.submitRequestToBackground)("resetOAuthLoginState"),t({type:O.RESET_SOCIAL_LOGIN_ONBOARDING})}catch(e){throw t(gt(e)),(0,M.isErrorWithMessage)(e)?new Error((0,M.getErrorMessage)(e)):e}finally{t(dt())}}}function U(t){return new Promise((e,n)=>{(0,C.callBackgroundMethod)("submitPassword",[t],t=>{t?n(t):e()})})}async function G(t,n,a){const r=Array.from(e.from(n,"utf8").values());await(0,C.submitRequestToBackground)("createSeedPhraseBackup",[t,r,a])}function H(t){return new Promise((e,n)=>{(0,C.callBackgroundMethod)("createNewVaultAndKeychain",[t],(t,a)=>{t?n(t):e(a)})})}function x(t){return new Promise((e,n)=>{(0,C.callBackgroundMethod)("verifyPassword",[t],t=>{t?n(t):e(!0)})})}async function K(t,n){const a=await(0,C.submitRequestToBackground)("getSeedPhrase",[t,n]);return e.from(a).toString("utf8")}function V(t){return{type:O.UPDATE_CUSTOM_NONCE,value:t}}function j(t){return e=>{e({type:O.COMPLETED_TX,value:{id:t}})}}function Q(t,e){return{type:O.UPDATE_TRANSACTION_PARAMS,id:t,value:e}}async function Y(t){return(0,C.submitRequestToBackground)("handleSnapRequest",[t])}function $(){return t=>new Promise(t=>{(0,C.callBackgroundMethod)("unMarkPasswordForgotten",[],()=>{t()})}).then(()=>ht(t))}function z(){return{type:O.UNLOCK_IN_PROGRESS}}function X(t){return{type:O.UNLOCK_FAILED,value:t}}function Z(t){return{type:O.UNLOCK_SUCCEEDED,value:t}}function J(t){return{type:O.SET_SHOW_CONNECTIONS_REMOVED,value:t}}function tt(t){return(e,n)=>{var a,r;const s=n(),i=(0,m.getProviderConfig)(s),{metamask:c}=s;if(null==t||!t.length)return c;const u=function(t,e){const n={...t};for(const t of e){const{op:e,path:a,value:r}=t;if("replace"!==e)throw new Error(`Unsupported patch operation: ${e}`);n[a[0]]=r}return n}(c,t),{currentLocale:d}=c,l=(0,w.getSelectedInternalAccount)(s),g=null==l?void 0:l.address,{currentLocale:f}=u,h=(0,m.getProviderConfig)({metamask:u}),T=(0,w.getSelectedInternalAccount)({metamask:u}),k=null==T?void 0:T.address;d&&f&&d!==f&&e(Tt(f)),g!==k&&e({type:O.SELECTED_ADDRESS_CHANGED});const p=(null===(a=u.addressBook)||void 0===a?void 0:a[null==h?void 0:h.chainId])??{},b=(null===(r=c.addressBook)||void 0===r?void 0:r[null==i?void 0:i.chainId])??{},E=(0,w.getMetaMaskAccounts)({metamask:u}),S=(0,w.getMetaMaskAccounts)({metamask:c}),R=E[k],A=E[g];return Object.entries(S).forEach(([t,n])=>{(0,o.isEqual)(n,E[t])||e({type:O.ACCOUNT_CHANGED,payload:{account:E[t]}})}),!1===(0,o.isEqual)(A,R)&&e({type:O.SELECTED_ACCOUNT_CHANGED,payload:{account:R}}),!1===(0,o.isEqual)(b,p)&&e({type:O.ADDRESS_BOOK_UPDATED,payload:{addressBook:p}}),!1===(0,o.isEqual)(c.gasFeeEstimates,u.gasFeeEstimates)&&e({type:O.GAS_FEE_ESTIMATES_UPDATED,payload:{gasFeeEstimates:u.gasFeeEstimates,gasEstimateType:u.gasEstimateType}}),e({type:O.UPDATE_METAMASK_STATE,value:u}),i.chainId!==h.chainId&&(e({type:O.CHAIN_CHANGED,payload:h.chainId}),e((0,y.initializeSendState)({chainHasChanged:!0}))),u}}const et=()=>new Promise((t,e)=>{(0,C.callBackgroundMethod)("setLocked",[],n=>{n?e(n):t()})});async function nt(t){r.default.debug("background.setSelectedInternalAccount"),await(0,C.submitRequestToBackground)("setSelectedInternalAccount",[t])}function at(){return{type:O.SHOW_ACCOUNTS_PAGE}}function rt({id:t}={}){return{type:O.SHOW_CONF_TX_PAGE,id:t}}function ot(t){return async()=>{r.default.debug(`background.setActiveNetworkConfigurationId: ${t}`);try{await(0,C.submitRequestToBackground)("setActiveNetworkConfigurationId",[t])}catch(t){(0,M.logErrorWithMessage)(t)}}}function st(t){return{type:O.MODAL_OPEN,payload:t}}function it(){return(t,e)=>{const n=e(),a=(0,w.getApprovalFlows)(n);(0,f.getEnvironmentType)()!==g.ENVIRONMENT_TYPE_NOTIFICATION||(0,w.hasTransactionPendingApprovals)(n)||(0,w.getIsSigningQRHardwareTransaction)(n)||0!==a.length||At()}}function ct(t){return{type:O.SHOW_LOADING,payload:t}}function ut(){return{type:O.SHOW_NFT_STILL_FETCHING_INDICATION}}function dt(){return{type:O.HIDE_LOADING}}function lt(){return{type:O.HIDE_NFT_STILL_FETCHING_INDICATION}}function gt(t){var e;return(0,M.isErrorWithMessage)(t)?{type:O.DISPLAY_WARNING,payload:(null==t||null===(e=t.cause)||void 0===e?void 0:e.message)||t.message}:"string"==typeof t?{type:O.DISPLAY_WARNING,payload:t}:{type:O.DISPLAY_WARNING,payload:`${t}`}}function ft(){return{type:O.HIDE_WARNING}}function wt(t,e,n=!0){return a=>(n&&a(ct()),new Promise((r,o)=>{(0,C.callBackgroundMethod)("setPreference",[t,e],(t,e)=>{if(n&&a(dt()),t)return a(gt(t)),void o(t);r(e)})}))}function mt(){return{type:O.COMPLETE_ONBOARDING}}function yt(){return{type:O.RESET_ONBOARDING}}async function ht(t){let e;try{e=await(0,C.submitRequestToBackground)("getStatePatches")}catch(e){throw t(gt(e)),e}return t(tt(e))}function Tt(t){return async e=>{e(ct());try{await(0,A.loadRelativeTimeFormatLocaleData)(t);const n=await(0,A.fetchLocale)(t),a=await(0,C.submitRequestToBackground)("setCurrentLocale",[t]);(0,l.switchDirection)(a),e(kt(t,n))}catch(t){return void e(gt(t))}finally{e(dt())}}}function kt(t,e){return{type:O.SET_CURRENT_LOCALE,payload:{locale:t,messages:e}}}function pt(t){return{type:O.SET_NEXT_NONCE,payload:t}}function bt(t){return{type:O.SET_REQUEST_ACCOUNT_TABS,payload:t}}function Et(t){return{type:O.SET_OPEN_METAMASK_TAB_IDS,payload:t}}async function St(t){return(0,C.submitRequestToBackground)("addPollingTokenToAppState",[t,g.POLLING_TOKEN_ENVIRONMENT_TYPES[(0,f.getEnvironmentType)()]])}async function Rt(t){return(0,C.submitRequestToBackground)("removePollingTokenFromAppState",[t,g.POLLING_TOKEN_ENVIRONMENT_TYPES[(0,f.getEnvironmentType)()]])}async function At(){try{const t=await a.default.windows.getCurrent();if(t.type&&"popup"!==t.type)return void console.warn(`Not safe to close a window that is not a popup: It is of type: ${t.type}`)}catch(t){console.warn("attemptCloseNotificationPopup: Error encountered while checking window type",t)}await(0,C.submitRequestToBackground)("markNotificationPopupAsAutomaticallyClosed"),window.close();try{const t=await a.default.tabs.getCurrent();await a.default.tabs.remove(t.id)}catch(t){console.error("attemptCloseNotificationPopup: Failed to close tab",t)}}function Bt(t,e){return(0,C.submitRequestToBackground)("trackMetaMetricsEvent",[{...t,actionId:(0,C.generateActionId)()},e])}async function Mt(t){await(0,C.submitRequestToBackground)("setUnconnectedAccountAlertShown",[t])}const Pt=async(t,e,n)=>{const a=e.map(e=>{const a={...t,maxFeePerGas:(0,B.decimalToHex)(e.maxFeePerGas),maxPriorityFeePerGas:(0,B.decimalToHex)(e.maxPriorityFeePerGas),gas:n?(0,B.decimalToHex)(21e3):t.gas,value:t.value};return n&&(a.to=a.from,a.data="0x"),a});return await(0,C.submitRequestToBackground)("approveTransactionsWithSameNonce",[a])}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"$root$",file:"ui/store/actions.ts"}],[7595,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.generateActionId=n.callBackgroundMethod=void 0,n.setBackgroundConnection=async function(t){a=t},n.submitRequestToBackground=r;let a;function r(t,e){return a[t](...e??[])}n.generateActionId=()=>Date.now()+Math.random();n.callBackgroundMethod=(t,e,n)=>{r(t,e).then(t=>n(null,t),n)}}}},{package:"$root$",file:"ui/store/background-connection.ts"}]],[],{});